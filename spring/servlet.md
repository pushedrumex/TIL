# Servlet

## WebServer vs WAS
- WebServer: 정적 리소스 제공 ex) NginX, APACHE
- WAS: 웹서버 기능 포함, 프로그램 코드(서블릿, 스프링 MVC)를 실행하여 어플리케이션 로직 수행 ex) 톰켓

## 서블릿이란?
- 서버에서 처리해야하는 업무 중 비지니스 로직을 제외한 업무를 해주는 역할
- 각 요청마다 서블릿이 존재
- 서버에서 처리해야하는 업무: 소켓 연결, 세션 관리, HTTP 요청 메시지 파싱, 메서드 구별, 비지니스 로직 실행, HTTP 응답 메시지 생성, 소켓 종료 등

## 서블릿 동작 원리
1. WAS 가 Request, Response 객체를 생성하여 서블릿 객체 호출
2. 개발자는 Request 객체에서 HTTP 요청 정보를 꺼내서 사용, Response 객체에 HTTP 응답 정보를 입력
3. WAS 는 Response 객체에 있는 내용을 HTTP 응답 전송

## 서블릿 컨테이너
- 서블릿을 지원하는 WAS
- 서블릿 객체의 생명 주기 관리
- 동시 요청을 위한 멀티 스레드 처리 지원
- 스레드풀에서 관리되는 스레드가 서블릿 객체를 호출하여 동작

## 스레드풀이란?
- 스레드를 미리 생성해놓고 관리하는 것
- 요청 시, 스레드 풀에 사용 가능한 스레드를 꺼내서 사용
- 톰켓은 기본적으로 200개의 스레드를 관리
- 최대 스레드 수를 낮게 설정하면 동시 요청이 많을 경우 서버 리소스가 여유롭더라도 클라이언트에 응답 지연
- 최대 스레드 수를 높게 하면 CPU, 메모리 리소스 임계점 초과로 서버 다운

## 디스패처 서블릿
- 디스패처 서블릿에서 모든 요청을 받고, 알맞은 컨트롤러 호출
- 공통 처리 기능
- 디스패처 서블릿에서만 서블릿을 사용하면 됨

## 디스패처 서블릿 동작 과정
1. 디스패처 서블릿이 핸들러 매핑 정보를 통해 URL에 매핑되는 컨트롤러 조회
2. 매핑된 컨트롤러를 처리할 수 있는 어댑터 조회
3. 어댑터를 통해 컨트롤러 실행
4. 컨트롤러 응답