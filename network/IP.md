# Network

### IPv4 vs IPv6
#### IPv4
```
127.0.0.1
```
- 현재 대부분 사용되고 있는 IP
- 32비트로 구성
- 8비트씩 점(.)으로 구분
- 각 영역은 0~255의 숫자로 표현
- 최대 2^32 = 약 40억개의 주소를 부여
- 사용자수가 많아지면서 주소 고갈 문제 예측 -> IPv6 등장

#### IPv6
```
ffff:2300:aaaa:ffff:bbbb:cccc:ffff:1111
```
- 128비트로 구성
- 16비트씩 콜론(:)으로 구분
- 최대 1조개 이상 주소를 부여

### Http version
#### HTTP 0.9
- 메서드는 GET 만 존재
- 헤더 없음
- 응답은 오직 데이터만 존재

#### HTTP 1.0
- 헤더 개념이 도입
- 메서드 추가
- content-type 추가: html 파일 외의 다른 타입 전송 가능
- 응답 상태 코드 추가
- 커넥션 하나 당 요청 하나와 응답 하나 처리하여 매번 새로운 연결 필요

#### HTTP 1.1
- 가장 많이 사용되는 프로토콜
- Persistent Connection 추가: timeout 동안 커넥션을 닫지 않는 방법
- Pipelining 추가: 하나의 커넥션에서 응답을 기다리지 않고 순차적으로 여러 요청을 연속적으로 전송하고 순서대로 응답을 받는 방식
- 후순위의 응답의 지연 문제 발생 -> Head Of Line Blocking

#### HTTP 2.0
- 플레인 텍스트에서 바이너리 형식으로 변경하여 파싱 속도 및 전송 속도 개선
- Multiplexed streams: 여러개의 요청을 병렬적으로 처리. 요청 순서에 상관 없이 완료된 순서대로 클라이언트에 전달

### SMTP
- Simple Mail Transfer Protocol
- 인터넷에서 메일을 보내기 위해 사용되는 프로토콜
- 메일을 전송하면 SMTP 서버로 전송되고 SMTP 서버에서 메일 전송 프로그램을 구동하여 메일을 전송 (SMTP 서버: gmail, naver 등)

### STOMP
- Simple Text Oriented Messaging Protocol
- 텍스트 기반의 메시지 프로토콜
- 브로커와 연결된 클라이언트 간에 메시지를 교환하는 방식으로 동작
- 양방향 네트워크 프로토콜 기반으로 동작 ex) WebSocket
- 브로커와 연결된 클라이언트 간에 메시지를 교환하는 방식으로 동작

### NAT(Network Address Translation)
- 사설 IP를 공인 IP로 변환해주는 기술
    - 내 컴퓨터의 IP를 공인 IP로 변환
    - 공유기는 출발지 IP와 Port 를 바꾸고 매핑 정보를 매핑 테이블에 저장
- 여러대의 컴퓨터가 인터넷으로 나갈 때 하나의 공인 IP를 공유하도록 IP 를 변환해주는 기술
- 공유기(라우터)에 매핑 테이블을 저장하고, 외부에서 응답이 오면 테이블을 보고 다시 내부로 돌려보냄
- 사설IP: 원래의 글로벌 주소 중 범위를 정하여 사내에서 사용하는 주소라고 약속한 것
    - 10.0.0.0 ~ 10.255.255.255
    - 172.16.0.0 ~ 172.31.255.255
    - 192.168.0.0 ~ 192.168.255.255
#### NAT이 필요한 이유
1. IPv4 주소 부족 문제 해결
- 원래의 모든 IP 주소는 공인IP였음 → 네트워크 접속 대수가 늘어나면서 미래에는 할당할 주소가 없어져버린다는 예측 등장. IPv4 주소는 약 43억개 뿐인데, 전세계 모든 장비(PC, 스마트폰)가 각각 하나씩 공인 IP를 쓰는 건 불가능함. 그래서 집, 회사, 기업 내부에서는 사설IP를 쓰고 인터넷에 나갈 때만 공유기 NAT가 하나의 공인 IP로 바꿔서 외부로 나감

2. 보안성 증가
- 외부에서 내부 사설 IP는 직접 접근할 수가 없음 NAT는 외부에서 임의로 내부 네트워크로 직접 연결하기 어렵게 만들기 때문에 기본적인 방화벽 역할을 자연스럽게 해줌. 매핑 테이블에 등록되어있지 않은 패킷이 도착할 경우 중계하지 안음 → 부정침입 방지 효과

3. IP 관리가 쉬워짐
- 회사나 집에서 네트워크 재구성, 장비 추가/삭제, 내부망 변경을 해도 공인 IP는 변하지 않기 때문에 관리가 쉬워짐

### VPN(Virtual Private Network)
- 공개된 인터넷 상에서 안전하게 사설 네트워크에 접속하기 위한 기술
- 내 집 PC 를 회사 내부 네트워크 안에 있는 것처럼 만들어주는 것
- 회사 VPN 서버가 내 요청을 받아서 회사 내부망으로 전달
- VPN 흐름

1. 집 컴퓨터에서 패킷 생성

```java
Source IP:   10.1.2.50     ← VPN이 준 내부 IP
Source Port: 12345
Dest IP:     10.0.0.5
Dest Port:   8080
```

2. 집 컴퓨터에 있는 VPN클라이언트가 해당 패킷을 암호화하여 회사 VPN 서버로 보냄

```java
Outer Source IP: 121.55.20.3   ← 너희 집 공유기 공인 IP(NAT)
Outer Dest IP:   52.77.88.10    ← 회사 VPN 서버 공인 IP
```

3. 회사 VPN 서버 도착

- VPN 서버는 외부 패킷을 까서 내부 패킷을 꺼내 회사 내부 라우터로 전달 → 회사 내부에서는 내 컴퓨터의 요청이 사내망에 있는 것과 동일하게 보임

```java
10.1.2.50 → 10.0.0.5:8080
```

4. 회사 내부 서버가 응답

```java
10.0.0.5:8080 → 10.1.2.50:12345
```

5. VPN 서버가 해당 패킷을 암호화하여 집 공유기 공인IP 로 전달

```java
Outer Source IP: 52.77.88.10
Outer Dest IP:   121.55.20.3
```

- VPN이 필요한 이유
1. 보안
- VPN은 암호화된 터널을 만들어 줌

2. 원격 접속
- 회사 내부의 네트워크에 접속해야할 경우, 마치 사무실 컴퓨터를 사용하는 거처럼 모든 자원 사용 가능

3. 우회 접속
- VPN 서버가 다른 나라에 있으면 그 나라에 접속한 것처럼 보이므로 지역 제한 된 서비스도 사용 가능
